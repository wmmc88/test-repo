name: Windows-Test

on:
  push:

env: 
  ROS_DISTRO: foxy

jobs:
  windows-amd64-build-and-test: # No rostooling/setup-ros-docker docker images available for Windows.
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-20.04, windows-latest]

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Setup ROS
        uses: ros-tooling/setup-ros@master
        # uses: wmmc88/setup-ros@wmmc88/install-correct-python-version-windows # includes openssl fix too
        with:
          required-ros-distributions: ${{ env.ROS_DISTRO }}
      - name: Build ROS2 Packages and Run Tests
        uses: wmmc88/action-ros-ci@wmmc88/fix-windows-builds--test-branch
        with:
          target-ros2-distro: ${{ env.ROS_DISTRO }}
